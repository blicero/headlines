{# -*- mode: jinja2; coding: utf-8; -*-
Time-stamp: <2025-10-20 17:21:43 krylon>
/data/code/python/headlines/web/templates/news.jinja
created on 13. 10. 2025
(c) 2025 Benjamin Walkenhorst
 #}

{% extends "main.jinja" %}

{% block title %}
  {{ title }}
{% endblock %}

{#
{% block intro %}
{% endblock %}

{% block menu %}
{% endblock %}
#}

{% block content %}
  <script>
    $(document).ready(() => {
        scale_images()
    })
  </script>

  <table class="table table-secondary table-striped">
    <thead>
      <tr>
        <th>Time</th>
        <th>Source</th>
        <th>Headline</th>
        <th>Rating</th>
        <th>Tags</th>
        <th>Details</th>
      </tr>
    </thead>

    <tbody class="items">
      {% for item in items %}
        <tr>
          <td>{{ item.stamp_str }}</td>
          <td>
            <a href="/feed/{{ item.feed_id }}">
              {{ feeds[item.feed_id].name }}
            </a>
          </td>
          <td><a target="_blank" href="{{ item.url }}">{{ item.headline }}</a></td>
          <td id="item_rating_{{ item.item_id }}"> {# Rating #}
            {% if item.is_rated %}
              {% if item.rating == 0 %}
                <img src="/static/face-tired.png" onclick="unrate_item({{ item.item_id }});" />
              {% else %}
                <img src="/static/face-glasses.png" onclick="unrate_item({{ item.item_id }});" />
              {% endif %}
            {% else %}
              <small>({{ item.effective_rating.name }})</small>
              <p>
              <button type="button"
                      class="btn btn-primary"
                      onclick="rate_item({{ item.item_id }}, 1);">
                      Interesting
              </button>
              <button type="button"
                      class="btn btn-secondary"
                      onclick="rate_item({{ item.item_id }}, 0);">
                      Boring
              </button>
            {% endif %}
          </td>
          <td> {# Tags #}
            <div id="tags_{{ item.item_id }}">
              {% for tag in item_tags %}
                <b>{{ tag.name }}</b>&nbsp;
              {% endfor %}
            </div>
            <div id="tag_suggestions_{{ item.item_id }}">
            </div>
            <div id="tag_form_{{ item.item_id }}">
              {% set id_root = "tag_menu_item_{}".format(item.item_id) %}
              <select id="item_tag_sel_{{ item.item_id }}" class="btn btn-secondary">
                {% for tag in tags %}
                  <option value="{{ tag.tag_id }}"
                          id="{{ id_root }}_opt_{{ tag.tag_id }}"
                          {%- if tag in item_tags[item.item_id] %} disabled="" {% endif -%}
                          >
                          {{- nbsp(tag.lvl*2) -}}
                          {{- tag.name -}}
                  </option>
                {% endfor %}
              </select>
              <button class="btn btn-success" onclick="add_tag({{ item.item_id }});">
                Add Tag
              </button>
            </div>
          </td>
          <td>
            <button class="btn btn-primary"
                    data-bs-toggle="collapse"
                    href="#collapse_item_{{ item.item_id }}"
                    aria-expanded="false"
                    aria-controls="#collapse_item_{{ item.item_id }}">
                    Description
            </button>
            <div class="collapse" id="collapse_item_{{ item.item_id }}">
              {{ item.clean_body }}
            </div>
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
{% endblock %}

{#
{% block footer %}
{% endblock %}
#}

